Содержание

--- Создание файла конфигурации (dialog)


--- Настройка сети
# Импортирование настроек из LiveCD
# Сетевой интерфейс по умолчанию
netstat -r | grep default | awk '{print $8}'
# Сетевые настройки ip,mask,bcast
ifconfig `netstat -r | grep default | awk '{print $8}'` | grep inet | awk -v RS=' ' '!(NR%1){gsub(/\n/," ");print} ' | sed -n '/inet/,/ /p'
# IP
ifconfig `netstat -r | grep default | awk '{print $8}'` | grep inet | awk -v RS=' ' '!(NR%1){gsub(/\n/," ");print} ' | sed -n '/inet/,/ /p' | grep -A 1 inet
# Netmask
ifconfig `netstat -r | grep default | awk '{print $8}'` | grep inet | awk -v RS=' ' '!(NR%1){gsub(/\n/," ");print} ' | sed -n '/inet/,/ /p' | grep -A 1 netmask
# broadcast
ifconfig `netstat -r | grep default | awk '{print $8}'` | grep inet | awk -v RS=' ' '!(NR%1){gsub(/\n/," ");print} ' | sed -n '/inet/,/ /p' | grep -A 1 broadcast
# Шлюз по умолчанию
netstat -r | grep default | awk '{print $2}'

--- Подготовка дисков
# Вывод информации по дискам
parted --list | grep Model -A2
# Стандартная установка ext4
parted -a optimal $DISK mklabel gpt
parted -a optimal $DISK unit mib
parted -a optimal $DISK mkpart primary 1 3
parted -a optimal $DISK name 1 grub
parted -a optimal $DISK set 1 bios_grub on
parted -a optimal $DISK mkpart primary 3 131
parted -a optimal $DISK name 2 boot
parted -a optimal $DISK mkpart primary 131 643
parted -a optimal $DISK name 3 swap
parted -a optimal $DISK mkpart primary 643 -1
parted -a optimal $DISK name 4 rootfs
parted -a optimal $DISK set 2 boot on
# Форматирование разделов
mkfs.ext4 /dev/sda2
mkfs.ext4 /dev/sda4
# Активация swap раздела
mkswap /dev/sda3
swapon /dev/sda3
# Монтирование разделов
mount /dev/sda4 /mnt/gentoo
mkdir /mnt/gentoo/boot
mount /dev/sda2 /mnt/gentoo/boot

--- Установка установочных файлов Gentoo
# Загрузка последнего среза
wget http://mirror.yandex.ru/gentoo-distfiles/releases/amd64/autobuilds/`lynx -source http://mirror.yandex.ru/gentoo-distfiles/releases/amd64/autobuilds/latest-stage3-amd64.txt | grep stage3 | awk '{print $1}'`

--- Установка базовой системы Gentoo


--- Настройка ядра Linux


--- Настройка параметров системы


--- Установка системных средств


--- Настройка начального загрузчика


--- Завершение установки
